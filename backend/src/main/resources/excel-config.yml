# Excel导入导出配置文件
# 配置说明:
#   - type: 任务类型唯一标识
#   - name: 任务名称描述
#   - sheets: Sheet配置列表
#     - name: Sheet名称
#     - sheetIndex: Sheet索引(从0开始)
#     - minRowLimit: 最小数据行数
#     - maxRowLimit: 最大数据行数
#     - headRowNumber: 表头行数(从第几行开始是数据)
#     - ormClass: ORM映射类(可选)
#     - columns: 列配置
#       - title: 列标题(表头显示)
#       - field: 对应的字段名
#       - fieldType: 字段类型(string/integer/long/double/date/boolean)
#       - dateFormat: 日期格式(fieldType为date时使用)
#       - required: 是否必填
#       - verifyExpression: 验证表达式(SpEL)
#       - errorMessage: 验证失败提示
#       - width: 列宽(导出时使用)
#       - exportable: 是否导出(默认true)
#       - importable: 是否导入(默认true)
#
# 支持的验证表达式:
#   - #notBlank(#val): 非空验证
#   - #empty(#val): 空值验证
#   - #lengthLessThan(#val, 64): 长度小于
#   - #lengthLessOrEquals(#val, 64): 长度小于等于
#   - #lengthBetween(#val, 1, 64): 长度范围
#   - #options(#val, '选项1', '选项2'): 选项验证
#   - #dateFormat(#val, 'yyyy/MM/dd'): 日期格式验证
#   - #doubleWithScale(#val, 2): 小数精度验证
#   - #doubleGreaterThan(#val, 0): 大于验证
#   - #doubleGreaterThanOrEquals(#val, 0): 大于等于验证
#   - #doubleBetween(#val, 0, 100): 范围验证
#   - #longGreaterThan(#val, 0): 整数大于
#   - #longGreaterThanOrEquals(#val, 0): 整数大于等于
#   - #longBetween(#val, 1, 100): 整数范围
#   - #isInteger(#val): 整数验证
#   - #isNumber(#val): 数值验证
#   - #isEmail(#val): 邮箱验证
#   - #isPhone(#val): 手机号验证
#   - #isIdCard(#val): 身份证验证
#   - #matches(#val, '正则表达式'): 正则匹配
#   - 支持逻辑运算: && (与), || (或), ! (非)

excel:
  tasks:
    # 用户数据导入
    - type: user_import
      name: 用户数据导入
      exportFileName: 用户数据
      maxParallelRunNum: 10
      sheets:
        - name: 用户信息
          sheetIndex: 0
          minRowLimit: 1
          maxRowLimit: 10000
          headRowNumber: 1
          columns:
            - title: 用户名
              field: username
              fieldType: string
              required: true
              verifyExpression: "#notBlank(#val) && #lengthBetween(#val, 3, 50)"
              errorMessage: 用户名长度必须在3-50个字符之间
              width: 20

            - title: 昵称
              field: nickname
              fieldType: string
              required: false
              verifyExpression: "#empty(#val) || #lengthLessThan(#val, 100)"
              errorMessage: 昵称长度不能超过100个字符
              width: 25

            - title: 邮箱
              field: email
              fieldType: string
              required: false
              verifyExpression: "#empty(#val) || #isEmail(#val)"
              errorMessage: 邮箱格式不正确
              width: 30

            - title: 手机号
              field: phone
              fieldType: string
              required: false
              verifyExpression: "#empty(#val) || #isPhone(#val)"
              errorMessage: 手机号格式不正确
              width: 15

            - title: 状态
              field: status
              fieldType: string
              required: true
              verifyExpression: "#options(#val, '启用', '禁用')"
              errorMessage: 状态只能是启用或禁用
              width: 10

    # 小说数据导入
    - type: novel_import
      name: 小说数据导入
      exportFileName: 小说数据
      maxParallelRunNum: 10
      sheets:
        - name: 小说信息
          sheetIndex: 0
          minRowLimit: 1
          maxRowLimit: 5000
          headRowNumber: 1
          columns:
            - title: 小说标题
              field: title
              fieldType: string
              required: true
              verifyExpression: "#notBlank(#val) && #lengthLessThan(#val, 200)"
              errorMessage: 小说标题为必填项且长度不能超过200个字符
              width: 40

            - title: 作者
              field: author
              fieldType: string
              required: true
              verifyExpression: "#notBlank(#val) && #lengthLessThan(#val, 100)"
              errorMessage: 作者为必填项且长度不能超过100个字符
              width: 20

            - title: 简介
              field: description
              fieldType: string
              required: false
              verifyExpression: "#empty(#val) || #lengthLessThan(#val, 1000)"
              errorMessage: 简介长度不能超过1000个字符
              width: 60

            - title: 分类
              field: category
              fieldType: string
              required: false
              verifyExpression: "#empty(#val) || #options(#val, '玄幻', '武侠', '都市', '历史', '科幻', '悬疑', '其他')"
              errorMessage: 分类不在可选范围内
              width: 15

            - title: 状态
              field: status
              fieldType: string
              required: true
              verifyExpression: "#options(#val, '连载中', '已完结')"
              errorMessage: 状态只能是连载中或已完结
              width: 12

            - title: 字数
              field: wordCount
              fieldType: long
              required: false
              verifyExpression: "#empty(#val) || #longGreaterThanOrEquals(#val, 0)"
              errorMessage: 字数必须大于等于0
              width: 15

    # 章节数据导入
    - type: chapter_import
      name: 章节数据导入
      exportFileName: 章节数据
      maxParallelRunNum: 10
      sheets:
        - name: 章节信息
          sheetIndex: 0
          minRowLimit: 1
          maxRowLimit: 20000
          headRowNumber: 1
          columns:
            - title: 小说ID
              field: novelId
              fieldType: long
              required: true
              verifyExpression: "#notBlank(#val) && #longGreaterThan(#val, 0)"
              errorMessage: 小说ID为必填项且必须大于0
              width: 15

            - title: 章节序号
              field: chapterNo
              fieldType: integer
              required: true
              verifyExpression: "#notBlank(#val) && #longGreaterThan(#val, 0)"
              errorMessage: 章节序号为必填项且必须大于0
              width: 12

            - title: 章节标题
              field: title
              fieldType: string
              required: true
              verifyExpression: "#notBlank(#val) && #lengthLessThan(#val, 200)"
              errorMessage: 章节标题为必填项且长度不能超过200个字符
              width: 40

            - title: 内容
              field: content
              fieldType: string
              required: false
              width: 80
              exportable: false

            - title: 字数
              field: wordCount
              fieldType: integer
              required: false
              verifyExpression: "#empty(#val) || #longGreaterThanOrEquals(#val, 0)"
              errorMessage: 字数必须大于等于0
              width: 12

    # 阅读进度数据导入导出
    - type: reading_progress
      name: 阅读进度数据
      exportFileName: 阅读进度
      maxParallelRunNum: 10
      sheets:
        - name: 阅读进度
          sheetIndex: 0
          minRowLimit: 1
          maxRowLimit: 50000
          headRowNumber: 1
          columns:
            - title: 用户ID
              field: userId
              fieldType: long
              required: true
              verifyExpression: "#notBlank(#val) && #longGreaterThan(#val, 0)"
              errorMessage: 用户ID必须大于0
              width: 15

            - title: 小说ID
              field: novelId
              fieldType: long
              required: true
              verifyExpression: "#notBlank(#val) && #longGreaterThan(#val, 0)"
              errorMessage: 小说ID必须大于0
              width: 15

            - title: 章节ID
              field: chapterId
              fieldType: long
              required: true
              verifyExpression: "#notBlank(#val) && #longGreaterThan(#val, 0)"
              errorMessage: 章节ID必须大于0
              width: 15

            - title: 阅读位置
              field: position
              fieldType: integer
              required: false
              verifyExpression: "#empty(#val) || #longGreaterThanOrEquals(#val, 0)"
              errorMessage: 阅读位置必须大于等于0
              width: 12

            - title: 阅读时间
              field: readTime
              fieldType: date
              dateFormat: yyyy-MM-dd HH:mm:ss
              required: false
              width: 20
